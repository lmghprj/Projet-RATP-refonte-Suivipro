global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'suivipro-ratp'
    environment: 'production'
    architecture: 'ddd'

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets: []

# Règles d'alerte
rule_files:
  # - "alerts/*.yml"

# Configuration des scrapes - Architecture DDD
scrape_configs:
  # Prometheus lui-même
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # MS-Agent - Gestion des dossiers agents
  - job_name: 'ms-agent'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-agent:8081']

  # MS-Habilitation - Gestion des habilitations
  - job_name: 'ms-habilitation'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-habilitation:8082']

  # MS-Formation - Gestion des formations et instructions
  - job_name: 'ms-formation'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-formation:8083']

  # MS-Securite - Gestion de la sécurité et des écarts
  - job_name: 'ms-securite'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-securite:8084']

  # MS-PAISF - Gestion PAISF
  - job_name: 'ms-paisf'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-paisf:8085']

  # MS-Alerte - Gestion des alertes
  - job_name: 'ms-alerte'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-alerte:8086']

  # MS-Objectif - Gestion des objectifs et indicateurs
  - job_name: 'ms-objectif'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-objectif:8087']

  # MS-Reporting - Reporting et BI
  - job_name: 'ms-reporting'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-reporting:8088']

  # MS-Organisation - Gestion de l'organisation
  - job_name: 'ms-organisation'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-organisation:8089']

  # MS-IAM - Identity & Access Management
  - job_name: 'ms-iam'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-iam:8090']

  # MS-Document - Gestion documentaire (GED)
  - job_name: 'ms-document'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-document:8091']

  # MS-Integration - Intégration SI
  - job_name: 'ms-integration'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-integration:8092']

  # MS-Notification - Gestion des notifications
  - job_name: 'ms-notification'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-notification:8093']

  # MS-Audit - Audit et traçabilité
  - job_name: 'ms-audit'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-audit:8094']

  # MS-Referentiel - Gestion des référentiels
  - job_name: 'ms-referentiel'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['ms-referentiel:8095']

  # API Gateway
  - job_name: 'api-gateway'
    static_configs:
      - targets: ['api-gateway:3001']

  # Infrastructure - Kafka (via JMX Exporter si configuré)
  - job_name: 'kafka'
    static_configs:
      - targets: ['kafka:9092']

  # Infrastructure - Zookeeper
  - job_name: 'zookeeper'
    static_configs:
      - targets: ['zookeeper:2181']

  # Infrastructure - MinIO
  - job_name: 'minio'
    metrics_path: '/minio/v2/metrics/cluster'
    static_configs:
      - targets: ['minio:9000']

  # Infrastructure - PostgreSQL (via postgres_exporter si configuré)
  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres:5432']

  # Infrastructure - Elasticsearch
  - job_name: 'elasticsearch'
    metrics_path: '/_prometheus/metrics'
    static_configs:
      - targets: ['elasticsearch:9200']
